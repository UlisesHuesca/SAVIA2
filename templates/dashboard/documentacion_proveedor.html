{% extends 'partials/base.html' %}
{% load crispy_forms_tags %}
{% load static %}
{% load widget_tweaks %}
{% load tt_extras %}
{% load l10n %}
<html>
<head>
{% block title %}Proveedores{% endblock %}
</head>
<body>
{% block content %}
<hr>
<hr>

<!-- Esta es la zona donde se crean los mensajes perrones con sweet alert -->
<div class="row my-4">
    <div class="col-md-4">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == "error" %}
                <script>
                Swal.fire({
                    "title":"Error",
                    "text":"{{message}}",
                    "icon":"error",
                })
                </script>
                {% else %}
                <script>
                Swal.fire({
                    "title":"Excelente",
                    "text":"{{message}}",
                    "icon":"success",
                })
                </script>
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>
</div>

   
<div class = "row">
<form method="POST">
    {% csrf_token %}
<div class ="row">
    <div class="col-sm-12 col-lg-6">
        
        <div class = "card mt-2 bg-white">
     
            <div class="card-header">
                <h5>Proveedor: {{proveedor.razon_social}}</h5>
            </div>
            <div class="card-body">
                <div class="d-flex justify-content-end">
                    <ul class="nav nav-pills">
                        <li class="nav-item mx-2">
                            <a class="btn btn-outline-info" id="btnActualizar" type="button" href="{{next}}">
                                <i class="fa-solid fa-backward"></i>
                            </a>
                        </li>
                        <li class="nav-item ms-4">
                           
                        </li>
                        <li class="nav-item ms-4">
                            
                        </li>
                    </ul>
                </div>
                    <table class="table table-striped">
                        <p class="text-center fw-bold">Tipo de Proveedor/Status Visita</p>
                        <thead>
                            <th>
                                Materiales
                            </th>
                            <th>
                                Servicios
                            </th>
                            <th>
                                Arrendamiento
                            </th>
                            <th>
                                Visita
                            </th>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    {% if tiene_producto %}
                                        <i class="fa-duotone fa-solid fa-circle-check alert-success fa-xl"></i>
                                    {% else %}
                                        <i class="fa-duotone fa-solid fa-circle-xmark alert-danger fa-xl"></i>
                                    {% endif %}
                                    <button class="btn btn-sm btn-outline-info mt-1" 
                                            onclick="toggleProducto({{ proveedor.id|unlocalize }})">
                                        Cambiar
                                    </button>
                                </td>
                                <td>
                                    {% if tiene_servicio %}
                                    <i class="fa-duotone fa-solid fa-circle-check alert-success fa-xl"></i>
                                    {% else %}
                                    <i class="fa-duotone fa-solid fa-circle-xmark alert-danger fa-xl"></i>
                                    {% endif %}
                                    <button class="btn btn-sm btn-outline-info mt-1" 
                                            onclick="toggleServicio({{ proveedor.id|unlocalize }})">
                                        Cambiar
                                    </button>
                                </td>
                                <td>
                                    {% if tiene_arrendamiento %}
                                    <i class="fa-duotone fa-solid fa-circle-check alert-success fa-xl"></i>
                                    {% else %}
                                    <i class="fa-duotone fa-solid fa-circle-xmark alert-danger fa-xl"></i>
                                    {% endif %}
                                    <button class="btn btn-sm btn-outline-info mt-1" 
                                            onclick="toggleArrendamiento({{ proveedor.id|unlocalize }})">
                                        Cambiar
                                    </button>
                                </td>
                                <td>
                                    {% if proveedor.visita %}
                                    <i class="fa-duotone fa-solid fa-circle-check alert-success fa-xl"></i>
                                    {% else %}
                                    <i class="fa-duotone fa-solid fa-circle-xmark alert-danger fa-xl"></i>
                                    {% endif %}
                                    <button class="btn btn-sm btn-outline-info mt-1" 
                                            onclick="toggleVisita({{ proveedor.id|unlocalize }})">
                                        Cambiar
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    
            </div>
        </div>
    </div>
    <div class="col-sm-12 col-lg-6">
        <div class = "card mt-2 bg-white">
     
            <div class="card-header">
                <h5>Proveedor: {{proveedor.razon_social}}</h5>
            </div>
    
            <div class="card-body">
                <table class = "table table-striped">
                    <thead>
                        <tr>
                            <th>Distrito</th>
                            <th>Status</th>
                            <th>Fecha de Evaluación</th>      
                        </tr>
                        <tbody>
                            {% for direccion in direcciones %}
                            <tr>
                                <td>{{direccion.distrito}}</td>
                                <!-- Columna editable -->
                                <td>
                                    <span id="estatus_display_{{ direccion.id|unlocalize }}">
                                        {% if direccion.estatus.nombre == "APROBADO" %}
                                            <span class="badge bg-primary">{{ direccion.estatus }}</span>
                                        {% elif direccion.estatus.nombre == "NUEVO" %}
                                            <span class="badge bg-warning">{{ direccion.estatus }}</span>
                                        {% elif direccion.estatus.nombre == "RECHAZADO" %}
                                            <span class="badge bg-danger">{{ direccion.estatus }}</span>
                                        {% else %}
                                            <span class="badge bg-secondary">Sin estatus</span>
                                        {% endif %}
                                    </span>

                                    <!-- Campo select oculto -->
                                    <select id="estatus_select_{{ direccion.id|unlocalize }}" class="form-select form-select-sm d-none" style="width: 130px;">
                                        <option value="NUEVO">NUEVO</option>
                                        <option value="APROBADO">APROBADO</option>
                                        <option value="RECHAZADO">RECHAZADO</option>
                                    </select>

                                    <button class="btn btn-sm btn-outline-info" type="button"
                                            id="edit_btn_{{ direccion.id|unlocalize }}"
                                            onclick="editarEstatus({{ direccion.id|unlocalize }})">
                                        <i class="fa-solid fa-pen"></i>
                                    </button>
                                    <button class="btn btn-sm btn-success d-none" type="button"
                                            id="save_btn_{{ direccion.id| unlocalize }}"
                                            onclick="guardarEstatus({{ direccion.id|unlocalize }})">
                                        <i class="fa-solid fa-check"></i>
                                    </button>
                                    <button class="btn btn-sm btn-secondary d-none" type="button"
                                            id="cancel_btn_{{ direccion.id | unlocalize }}"
                                            onclick="cancelarEstatus({{ direccion.id|unlocalize }})">
                                        <i class="fa-solid fa-xmark"></i>
                                    </button>
                                </td>
                                <td>
                                    <!-- Vista -->
                                    <span id="fecha_view_{{ direccion.id| unlocalize }}">
                                        {% if direccion.modificado_fecha %}
                                        {{ direccion.modificado_fecha }}
                                        {% else %}
                                        <i class="fa-duotone fa-solid fa-circle-xmark alert-danger fa-xl"></i>
                                        {% endif %}
                                    </span>

                                    <!-- Edición -->
                                    <span id="fecha_edit_{{ direccion.id|unlocalize }}" class="d-none">
                                        <input type="date"
                                            id="fecha_input_{{ direccion.id|unlocalize }}"
                                            class="form-control form-control-sm"
                                            value="{{ direccion.modificado_fecha|date:'Y-m-d' }}">
                                    </span>
                                    </td>

                                    <td class="text-end">
                                    <button type="button" class="btn btn-sm btn-outline-info"
                                            id="fecha_btn_edit_{{ direccion.id|unlocalize }}"
                                            onclick="fecha_edit({{ direccion.id|unlocalize }})">
                                        <i class="fa-solid fa-pen"></i>
                                    </button>
                                    <button type="button" class="btn btn-sm btn-success d-none"
                                            id="fecha_btn_save_{{ direccion.id|unlocalize }}"
                                            onclick="fecha_save({{ direccion.id|unlocalize }})">
                                        <i class="fa-solid fa-check"></i>
                                    </button>
                                    <button type="button" class="btn btn-sm btn-secondary d-none"
                                            id="fecha_btn_cancel_{{ direccion.id|unlocalize }}"
                                            onclick="fecha_cancel({{ direccion.id|unlocalize }})">
                                        <i class="fa-solid fa-xmark"></i>
                                    </button>
                                    </td>

                            </tr>
                            {% endfor %}
                        </tbody>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>    
<div class="col-sm-12 col-lg-12">
    <div class = "card">
        <div class="card-header">
            <h5>Documentación Legal y Contable</h5>
        </div>
            <div class="card-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Nombre del Documento</th>
                            <th>Documento</th>
                            <th>Información Adicional</th>
                            <th>Comentarios</th>
                            <th>Edit</th>
                            <th class="text-success">
                                <button type="submit" name="btn_validacion" class="btn btn-outline-success" title="Guardar validación" >
                                <i class="fa-duotone fa-solid fa-square-check fa-xl"></i>
                                </button>
                            </th>
                           
                            <th class="text-danger" title="Eliminar documento">
                                <button type="submit" name="btn_eliminar_docto" class="btn btn-outline-danger" title="Confirmar Eliminación" >
                                    <i class="fa-duotone fa-solid fa-trash-can fa-xl"></i>  
                                </button>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Credencial Elector/Acta Constitutiva</td>
                            <td>    
                                {% if documentos_count.credencial_acta_constitutiva == 0 %}
                                        <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Credencial" hx-target="#document" hx-get="{% url 'edit-acta-credencial' proveedor.id %}">
                                            <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                        </a>
                                {% else %}
                                        {% for documento in documentos %}
                                            {% if documento.tipo_documento == "credencial_acta_constitutiva" %}
                                                {% if documento.validada %}
                                                <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfActa{{documento.id|unlocalize }}" title="Ver Credencial/Acta">
                                                    <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                </button>
                                                {% else %}
                                                <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfActa{{documento.id|unlocalize }}" title="Ver Credencial/Acta">
                                                    <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                </button>
                                                {% endif %}
                                                
                                                <!-- Modal con visor de PDF -->
                                                <div class="modal fade" id="pdfActa{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfActaLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="pdfActaLabel{{documento.id|unlocalize }}">Credencial/Acta Constitutiva</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endif %}
                                        {% endfor %}
                                         <!-- Si hay al menos un documento sin validar, mostrar botón para cambiar -->
                                         {% if documentos_count.credencial_acta_constitutiva > documentos_validados_count.credencial_acta_constitutiva %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Actualizar Credencial" hx-target="#document" hx-get="{% url 'edit-acta-credencial' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% endif %}
                                {% endif %}
                            </td>
                            <td>
                               
                            </td>
                            <td class="" id="comentario_1_{{proveedor.id|unlocalize}}" tipo = "acta">{% if proveedor.comentario_acta %} {{proveedor.comentario_acta}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_1_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_1_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_1_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 1)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_1_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 1)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_1_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}',1)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "credencial_acta_constitutiva" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "credencial_acta_constitutiva" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                            {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Constancia de Situación Fiscal</td>
                            <td>  
                                {% if documentos_count.csf == 0 %}
                                    <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Constancia" hx-target="#document" hx-get="{% url 'edit-csf' proveedor.id %}">
                                        <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                    </a>
                                    {% else %}
                                        {% for documento in documentos %}
                                            {% if documento.tipo_documento == "csf" %}
                                                {% if documento.validada %}
                                                    <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfModal{{documento.id|unlocalize }}" title="Constancia de Situación Fiscal| Validada">
                                                        <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                    </button>
                                                {% else %}
                                                    <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfModal{{documento.id|unlocalize }}" title="Constancia de Situación Fisca| Pendiente Validación">
                                                        <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                    </button>
                                                {% endif %}
                                            <!-- Modal con visor de PDF -->
                                            <div class="modal fade" id="pdfModal{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfModalLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                <div class="modal-dialog modal-xl">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="pdfModalLabel{{documento.id|unlocalize }}">Constancia de Situación Fiscal</h5>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            {% endif %}
                                        {% endfor %}
                                        {% if documentos_count.csf > documentos_validados_count.csf %}
                                        <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Constancia" hx-target="#document" hx-get="{% url 'edit-csf' proveedor.id %}">
                                            <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                        </a> 
                                        {% endif %}
                                {% endif %}
                            
                        
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "csf"%}
                                        {% if documento.fecha_emision %}
                                            <p><strong>Fecha de Emisión:</strong> {{ documento.fecha_emision }}</p>
                                            <p><strong>Fecha de Vencimiento:</strong> {{documento.fecha_vencimiento }}</strong></p>
                                        {% else %}
                                            <p><strong>Fecha de Emisión:</strong> No disponible </p>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td class="" id="comentario_2_{{proveedor.id|unlocalize}}" tipo = "csf">{% if proveedor.comentario_csf %} {{proveedor.comentario_csf}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_2_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_2_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_2_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}',2)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_2_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 2)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_2_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 2)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            <td>
                                {% for documento in documentos  %}
                                    {% if documento.tipo_documento == "csf" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "csf" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Comprobante de Domicilio</td>
                            <td>
                               
                                 
                                    {% if documentos_count.comprobante_domicilio == 0 %}  
                                        <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Domicilio" hx-target="#document" hx-get="{% url 'edit-comprobante-domicilio' proveedor.id %}">
                                            <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                        </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "comprobante_domicilio" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfDomicilio{{documento.id|unlocalize }}" title="Ver Comprobante de Domicilio">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfDomicilio{{documento.id|unlocalize }}" title="Ver Comprobante de Domicilio">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}
                                            
                                                <!-- Modal con visor de PDF -->
                                                <div class="modal fade" id="pdfDomicilio{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfDomicilioLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="pdfDomicilioLabel{{documento.id|unlocalize }}">Comprobante de Domicilio</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.comprobante_domicilio > documentos_validados_count.comprobante_domicilio %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Comprobante de Domicilio" hx-target="#document" hx-get="{% url 'edit-comprobante-domicilio' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                    
                            </td>
                            <td></td>
                            <td class="" id="comentario_3_{{proveedor.id|unlocalize}}" tipo ="domicilio" >{% if proveedor.comentario_comprobante_domicilio %} {{proveedor.comentario_comprobante_domicilio}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_3_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_3_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_3_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 3)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_3_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 3)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_3_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 3)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>

                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "comprobante_domicilio" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "comprobante_domicilio" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                            {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Opinión de Cumplimiento 32D</td>
                            <td>
                             
                                        {% if documentos_count.opinion_cumplimiento == 0 %}   
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Opinion" hx-target="#document" hx-get="{% url 'edit-opinion-cumplimiento' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "opinion_cumplimiento" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfOpinion{{documento.id|unlocalize }}" title="Ver Opinión de Cumplimiento">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfOpinion{{documento.id|unlocalize }}" title="Ver Opinión de Cumplimiento">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}

                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfOpinion{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfOpinionLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfOpinionLabel{{documento.id|unlocalize }}">Opinión de Cumplimiento</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.opinion_cumplimiento > documentos_validados_count.opinion_cumplimiento %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Opinión de Cumplimiento 32D" hx-target="#document" hx-get="{% url 'edit-opinion-cumplimiento' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "opinion_cumplimiento"%}
                                        {% if documento.fecha_emision %}
                                            <p><strong>Fecha de Emisión:</strong> {{ documento.fecha_emision }}</p>
                                            <p><strong>Fecha de Vencimiento:</strong> {{documento.fecha_vencimiento }}</strong></p>
                                        {% else %}
                                            <p><strong>Fecha de Emisión:</strong> No disponible </p>
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td class="" id="comentario_4_{{proveedor.id|unlocalize}}" tipo ="opinion" >{% if proveedor.comentario_opinion_cumplimiento %} {{proveedor.comentario_opinion_cumplimiento}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_4_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_4_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_4_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 4)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_4_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 4)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_4_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 4)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "opinion_cumplimiento" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "opinion_cumplimiento" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Calificación</td>
                            <td>

                                        {% if documentos_count.calificacion == 0 %}   
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documento Calificación" hx-target="#document" hx-get="{% url 'edit-calificacion' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "calificacion" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfCalificacion{{documento.id|unlocalize }}" title="Ver Documento Calificación">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfCalificacion{{documento.id|unlocalize }}" title="Ver Documento Calificación">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}

                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfCalificacion{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfCalificacionLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfCalificacionLabel{{documento.id|unlocalize }}">Documento Calificación</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.calificacion > documentos_validados_count.calificacion %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documentos Calificación" hx-target="#document" hx-get="{% url 'edit-calificacion' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td>
                            
                            </td>
                            <td class="" id="comentario_9_{{proveedor.id|unlocalize}}" tipo ="calificacion" >{% if proveedor.comentario_calificacion %} {{proveedor.comentario_calificacion}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_9_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_9_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_9_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 9)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_9_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 9)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_9_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 9)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "calificacion" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "calificacion" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Visita</td>
                            <td>

                                {% if documentos_count.visita == 0 %}   
                                    <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documento Visita" hx-target="#document" hx-get="{% url 'edit-visita' proveedor.id %}">
                                        <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                    </a>
                                {% else %}
                                    {% for documento in documentos %}
                                        {% if documento.tipo_documento == "visita" %}
                                            {% if documento.validada %}
                                                <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfVisita{{documento.id|unlocalize }}" title="Ver Documento Visita">
                                                    <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                </button>
                                            {% else %}
                                                <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfVisita{{documento.id|unlocalize }}" title="Ver Documento Visita">
                                                    <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                </button>
                                            {% endif %}

                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfVisita{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfVisitaLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfVisitaLabel{{documento.id|unlocalize }}">Documento Visita</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.visita > documentos_validados_count.visita %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documentos Visita" hx-target="#document" hx-get="{% url 'edit-visita' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td>
                            
                            </td>
                            <td class="" id="comentario_12_{{proveedor.id|unlocalize}}" tipo ="visita" >{% if proveedor.comentario_visita %} {{proveedor.comentario_visita}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_12_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_12_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_12_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 12)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_12_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 12)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_12_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 12)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "visita" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "visita" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Calidad</td>
                            <td>
                             
                                        {% if documentos_count.calidad == 0 %}   
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documento Calidad" hx-target="#document" hx-get="{% url 'edit-calidad' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "calidad" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfCalidad{{documento.id|unlocalize }}" title="Ver Documento Calidad">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfCalidad{{documento.id|unlocalize }}" title="Ver Documento Calidad">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}

                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfCalidad{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfCalidadLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfCalidadLabel{{documento.id|unlocalize }}">Documento Calidad</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.calidad > documentos_validados_count.calidad %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documentos de Calidad" hx-target="#document" hx-get="{% url 'edit-calidad' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td>
                            
                            </td>
                            <td class="" id="comentario_11_{{proveedor.id|unlocalize}}" tipo ="calidad" >{% if proveedor.comentario_calidad %} {{proveedor.comentario_calidad}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_11_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_11_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_11_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 11)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_11_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 11)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_11_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 11)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "calidad" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "calidad" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Cotización</td>
                            <td>
                             
                                        {% if documentos_count.cotizacion == 0 %}   
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Cotización" hx-target="#document" hx-get="{% url 'edit-cotizacion' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "cotizacion" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfCotizacion{{documento.id|unlocalize }}" title="Ver Cotización">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfCotizacion{{documento.id|unlocalize }}" title="Ver Cotización">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}

                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfCotizacion{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfCotizacionLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfCotizacionLabel{{documento.id|unlocalize }}">Cotización</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.cotizacion > documentos_validados_count.cotizacion %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documentos de Calidad" hx-target="#document" hx-get="{% url 'edit-calidad' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td>
                            
                            </td>
                            <td class="" id="comentario_13_{{proveedor.id|unlocalize}}" tipo ="cotizacion" >{% if proveedor.comentario_cotizacion %} {{proveedor.comentario_cotizacion}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_13_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_13_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_13_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 13)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_13_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 13)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_13_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 13)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "cotizacion" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "cotizacion" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Otros</td>
                            <td>
                             
                                        {% if documentos_count.otros == 0 %}   
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documento" hx-target="#document" hx-get="{% url 'edit-otros' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "otros" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfOtros{{documento.id|unlocalize }}" title="Ver Documento">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfOtros{{documento.id|unlocalize }}" title="Ver Documento">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}

                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfOtros{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfOtrosLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfOtrosLabel{{documento.id|unlocalize }}">Documento</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.otros > documentos_validados_count.otros %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documento" hx-target="#document" hx-get="{% url 'edit-otros' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td>
                            
                            </td>
                            <td class="" id="comentario_10_{{proveedor.id|unlocalize}}" tipo ="otros" >{% if proveedor.comentario_otros %} {{proveedor.comentario_otros}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_10_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_10_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_10_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 10)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_10_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 10)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_10_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 10)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "otros" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "otros" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            {% if proveedor.ultimo_cuestionario %}
                            <td>
                                Cuestionario Debida Diligencia
                            </td>
                            <td>
                                <a class="btn btn-outline-info" id="btnProveedorDirecciones" type="button" href="{% url 'descargar-pdf-dd' proveedor.id %}?next={{request.path}}?razon_social={{ request.GET.razon_social }}&rfc={{ request.GET.rfc }}">
                                    <i class="fa-duotone fa-solid fa-file-check"></i>
                                </a>
                            </td>
                            <td>
                               {{ proveedor.ultimo_cuestionario.fecha}}
                            </td>
                            <td>

                            </td>
                            <td>

                            </td>
                            <td>

                            </td>
                            <td>

                            </td>
                            {% endif %}
                        </tr>
                        <tr>
                            <td>Carta de Crédito</td>
                            <td>

                                {% if documentos_count.carta_credito == 0 %}   
                                    <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documento Visita" hx-target="#document" hx-get="{% url 'edit-carta-credito' proveedor.id %}">
                                        <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                    </a>
                                {% else %}
                                    {% for documento in documentos %}
                                        {% if documento.tipo_documento == "carta_credito" %}
                                            {% if documento.validada %}
                                                <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfCredito{{documento.id|unlocalize }}" title="Ver Carta de Crédito">
                                                    <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                </button>
                                            {% else %}
                                                <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfCredito{{documento.id|unlocalize }}" title="Ver Carta de Crédito">
                                                    <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                </button>
                                            {% endif %}

                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfCredito{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfCreditoLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfCreditoLabel{{documento.id|unlocalize }}">Carta de Crédito</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.carta_credito > documentos_validados_count.carta_credito %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Carta de Crédito" hx-target="#document" hx-get="{% url 'edit-carta-credito' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td>
                            
                            </td>
                            <td class="" id="comentario_14_{{proveedor.id|unlocalize}}" tipo ="carta_credito" >{% if proveedor.comentario_carta_credito %} {{proveedor.comentario_carta_credito}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_14_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_14_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_14_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 14)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_14_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 14)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_14_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 14)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "carta_credito" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "carta_credito" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>
                        </tr>
                        <tr>
                            <td>Búsqueda Mediática</td>
                            <td>
                             
                                        {% if documentos_count.busqueda_mediatica == 0 %}   
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Búsqueda Mediática" hx-target="#document" hx-get="{% url 'edit-busqueda' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "busqueda_mediatica" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfBusqueda{{documento.id|unlocalize }}" title="Ver Búsqueda Mediática">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfBusqueda{{documento.id|unlocalize }}" title="Ver Búsqueda Mediática">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}

                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfBusqueda{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfBusquedaLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfBusquedaLabel{{documento.id|unlocalize }}">Búsqueda Medíatica</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.busqueda_mediatica > documentos_validados_count.busqueda_mediatica %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Documentos de Calidad" hx-target="#document" hx-get="{% url 'edit-busqueda' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td>
                            
                            </td>
                            <!-- <td class="" id="comentario_14_{{proveedor.id|unlocalize}}" tipo ="busqueda_mediatica" >{% if proveedor.comentario_busqueda %} {{proveedor.comentario_busqueda}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_14_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_14_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_14_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 14)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_14_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 14)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_14_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 14)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td>
                            
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "busqueda_mediatica" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                       
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "busqueda_mediatica" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>-->
                            <td>

                            </td>
                            <td>

                            </td>
                            <td>

                            </td>
                            <td>

                            </td>
                        </tr>
                          
                    </tbody>
                </table>

            </div>
     </div>
</div>

{% if tiene_servicio %}
    <div class="col-lg-12">
        <div class ="card mt-2 bg-white">
            <div class ="card-header">
                <h5>Complementaria Proveedor de Servicios</h5>
            </div>
            <div class ="card-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Nombre del Documento</th>
                            <th>Documento</th>
                            <th>Comentarios</th>
                            <th>Edit</th>
                            <th class="text-success">
                                <button type="submit" name="btn_validacion" class="btn btn-outline-success" title="Guardar validación" >
                                <i class="fa-duotone fa-solid fa-square-check fa-xl"></i>
                                </button>
                            </th>
                           
                            <th class="text-danger" title="Eliminar documento">
                                <button type="submit" name="btn_eliminar_docto" class="btn btn-outline-danger" title="Confirmar Eliminación" >
                                    <i class="fa-duotone fa-solid fa-trash-can fa-xl"></i>  
                                </button>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if not tiene_arrendamiento %}
                        <tr>
                            <td>Contrato</td>
                            <td>
                                        {% if documentos_count.contrato == 0 %} 
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Credencial" hx-target="#document" hx-get="{% url 'subir-documento-contrato' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "contrato" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfContrato{{documento.id|unlocalize }}" title="Ver Contrato">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfContrato{{documento.id|unlocalize }}" title="Ver Contrato">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}
                                                <!-- Modal con visor de PDF -->
                                                <div class="modal fade" id="pdfContrato{{ documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfContratoLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="pdfContratoLabel{{documento.id|unlocalize }}">Contratos</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                 
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.contrato > documentos_validados_count.contrato %}
                                                <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Subir Contrato" hx-target="#document" hx-get="{% url 'subir-documento-contrato' proveedor.id %}">
                                                    <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                                </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td class="" id="comentario_7_{{proveedor.id|unlocalize}}" tipo ="contrato" >
                                {% if proveedor.comentario_contrato %} {{proveedor.comentario_contrato}} {% endif %}
                            </td>
                            <td class="d-none" id="form_comentario_7_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_7_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_7_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 7)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_7_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 7)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_7_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 7)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                            </td> 
                            <td>
                            {% for documento in proveedor.documentos.all %}
                                {% if documento.tipo_documento == "contrato" %}
                                    <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                {% endif %}
                            {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "contrato" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </td>
                        </tr>
                        {% endif %}

                        <tr>
                            <td>Curriculum de Servicios</td>
                            <td> 
                             
                                        {% if documentos_count.curriculum == 0 %}    
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar CV" hx-target="#document" hx-get="{% url 'edit-curriculum' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "curriculum" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfCV{{documento.id|unlocalize }}" title="Ver Curriculum Vitae">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfCV{{documento.id|unlocalize }}" title="Ver Curriculum Vitae">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}

                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfCV{{documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfCVLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfCVLabel{{documento.id|unlocalize }}">Curriculum Vitae</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                   
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.curriculum > documentos_validados_count.curriculum %}
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar comprobante" hx-target="#document" hx-get="{% url 'edit-curriculum' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% endif %}
                                        {% endif %}
                                   
                            </td> 
                            <td class="" id="comentario_5_{{proveedor.id|unlocalize}}" tipo ="cv" >{% if proveedor.comentario_curriculum %} {{proveedor.comentario_curriculum}} {% endif %}</td>
                            <td class="d-none" id="form_comentario_5_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_5_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_5_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 5)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_5_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 5)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_5_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 5)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                                
                            </td> 
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "curriculum" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "curriculum" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>

                        </tr>
                        <tr>
                            <td>Competencias</td>
                            <td>
                              
                                        {% if documentos_count.competencias == 0 %} 
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Competencias" hx-target="#document" hx-get="{% url 'subir-documento-competencia' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "competencias" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfCompetencias{{documento.id|unlocalize }}" title="Ver Competencia">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfCompetencias{{documento.id|unlocalize }}" title="Ver Competencia">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}
                                                <!-- Modal con visor de PDF -->
                                                <div class="modal fade" id="pdfCompetencias{{ documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfCompetenciasLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="pdfCompetenciasLabel{{documento.id|unlocalize }}">Competencias</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.competencias > documentos_validados_count.competencias %}
                                                <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Competencias" hx-target="#document" hx-get="{% url 'subir-documento-competencia' proveedor.id %}">
                                                    <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                                </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td class="" id="comentario_6_{{proveedor.id|unlocalize}}" tipo ="competencias" >
                                {% if proveedor.comentario_competencias %} {{proveedor.comentario_competencias}} {% endif %}
                            </td>
                            <td class="d-none" id="form_comentario_6_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_6_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_6_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 6)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_6_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 6)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_6_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 6)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                            </td> 
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "competencias" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "competencias" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>

                           
                        </tr>
                        <tr>
                            <td>Opinión de cumplimiento del IMSS</td>
                            <td>
                              
                                        {% if documentos_count.cumplimiento_imss == 0 %} 
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Opinión de cumplimiento" hx-target="#document" hx-get="{% url 'edit-cumplimiento-imss' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "cumplimiento_imss" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfImss{{documento.id|unlocalize }}" title="Ver Opinión de cumplimiento del IMSS">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfImss{{documento.id|unlocalize }}" title="Ver Opinión de cumplimiento del IMSS">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}
                                                <!-- Modal con visor de PDF -->
                                                <div class="modal fade" id="pdfImss{{ documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfImssLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="pdfImssLabel{{documento.id|unlocalize }}">Imss</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.cumplimiento_imss > documentos_validados_count.cumplimiento_imss %}
                                                <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Cumplimiento Imss" hx-target="#document" hx-get="{% url 'edit-cumplimiento-imss' proveedor.id %}">
                                                    <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                                </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td class="" id="comentario_15_{{proveedor.id|unlocalize}}" tipo ="cumplimiento_imss" >
                                {% if proveedor.comentario_cumplimiento_imss %} {{proveedor.comentario_cumplimiento_imss}} {% endif %}
                            </td>
                            <td class="d-none" id="form_comentario_15_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_15_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_15_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 15)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_15_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 15)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_15_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 15)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                            </td> 
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "cumplimiento_imss" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "cumplimiento_imss" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>

                           
                        </tr>
                           <tr>
                            <td>Repse</td>
                            <td>
                              
                                        {% if documentos_count.repse == 0 %} 
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Repse" hx-target="#document" hx-get="{% url 'edit-repse' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "repse" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfRepse{{documento.id|unlocalize }}" title="Ver Repse">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfRepse{{documento.id|unlocalize }}" title="Ver Repse">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}
                                                <!-- Modal con visor de PDF -->
                                                <div class="modal fade" id="pdfRepse{{ documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfRepseLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="pdfRepseLabel{{documento.id|unlocalize }}">Imss</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.repse > documentos_validados_count.repse %}
                                                <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Cumplimiento Imss" hx-target="#document" hx-get="{% url 'edit-repse' proveedor.id %}">
                                                    <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                                </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td class="" id="comentario_16_{{proveedor.id|unlocalize}}" tipo ="repse" >
                                {% if proveedor.comentario_repse %} {{proveedor.comentario_repse}} {% endif %}
                            </td>
                            <td class="d-none" id="form_comentario_16_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_16_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_16_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 16)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_16_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 16)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_16_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 16)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                            </td> 
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "repse" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "repse" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}

                            </td>

                           
                        </tr>
                    </tbody> 
                </table>
            </div>
        </div>
    </div>
    {% endif %}
    <div id="loadingIndicator" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1000;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: flex; flex-direction: row; align-items: center; justify-content: center;">
            <img src="{% static 'images/SAVIA_Logo.png' %}" alt="Logo" style="width: 100px; height: 100px; border-radius: 50%; margin-right: 10px;">
            <p style="color: white; margin: 0;">Subiendo archivo, por favor espera...&nbsp;<i class="fa-solid fa-mug-hot"></i></p>
        </div>
    </div>
    {% if tiene_arrendamiento %}
    <div class="col-md-12">
        <div class ="card mt-2 bg-white">
            <div class ="card-header">
                <h5>Complementaria proveedor Arrendamiento</h5>
            </div>
            <div class ="card-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Nombre del Documento</th>
                            <th>Documento</th>
                            <th>Comentarios</th>
                            <th>Edit</th>
                            <th class="text-success">
                                <button type="submit" name="btn_validacion" class="btn btn-outline-success" title="Guardar validación" >
                                <i class="fa-duotone fa-solid fa-square-check fa-xl"></i>
                                </button>
                            </th>
                           
                            <th class="text-danger" title="Eliminar documento">
                                <button type="submit" name="btn_eliminar_docto" class="btn btn-outline-danger" title="Confirmar Eliminación" >
                                    <i class="fa-duotone fa-solid fa-trash-can fa-xl"></i>  
                                </button>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Contrato</td>
                            <td>
                                        {% if documentos_count.contrato == 0 %} 
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Credencial" hx-target="#document" hx-get="{% url 'subir-documento-contrato' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "contrato" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdfContrato{{documento.id|unlocalize }}" title="Ver Contrato">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfContrato{{documento.id|unlocalize }}" title="Ver Contrato">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}
                                                <!-- Modal con visor de PDF -->
                                                <div class="modal fade" id="pdfContrato{{ documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfContratoLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="pdfContratoLabel{{documento.id|unlocalize }}">Contratos</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                 
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.contrato > documentos_validados_count.contrato %}
                                                <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Subir Contrato" hx-target="#document" hx-get="{% url 'subir-documento-contrato' proveedor.id %}">
                                                    <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                                </a>
                                            {% endif %}
                                        {% endif %}
                                   
                            </td>
                            <td class="" id="comentario_7_{{proveedor.id|unlocalize}}" tipo ="contrato" >
                                {% if proveedor.comentario_contrato %} {{proveedor.comentario_contrato}} {% endif %}
                            </td>
                            <td class="d-none" id="form_comentario_7_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_7_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_7_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 7)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_7_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 7)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_7_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 7)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                            </td> 
                            <td>
                            {% for documento in proveedor.documentos.all %}
                                {% if documento.tipo_documento == "contrato" %}
                                    <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validada %}checked{% endif %}>
                                {% endif %}
                            {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "contrato" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </td>
                        </tr>
                        <tr>
                            <td>Factura del Bien/Predial</td>
                            <td>
                               
                                        {% if documentos_count.factura_predial == 0 %}  
                                            <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Predial" hx-target="#document" hx-get="{% url 'subir-documento-factura-predial' proveedor.id %}">
                                                <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                            </a>
                                        {% else %}
                                            {% for documento in documentos %}
                                                {% if documento.tipo_documento == "factura_predial" %}
                                                    {% if documento.validada %}
                                                        <button type="button" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#pdPredial{{ documento.id|unlocalize }}" title="Ver Factura/Predial">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% else %}
                                                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#pdfPredial{{ documento.id|unlocalize }}" title="Ver Factura/Predial">
                                                            <i class="fa-duotone fa-solid fa-file-pdf fa-xl" aria-hidden="true"></i>
                                                        </button>
                                                    {% endif %}
                                                
                                                    <!-- Modal con visor de PDF -->
                                                    <div class="modal fade" id="pdfPredial{{ documento.id|unlocalize }}" tabindex="-1" aria-labelledby="pdfPredialLabel{{documento.id|unlocalize }}" aria-hidden="true">
                                                        <div class="modal-dialog modal-xl">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="pdfPredialLabel{{documento.id|unlocalize }}">Predial/Factura del Bien</h5>
                                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <iframe src="{{ documento.archivo.url }}#zoom=80" width="100%" height="750px"></iframe>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                {% endif %}
                                            {% endfor %}
                                            {% if documentos_count.factura_predial > documentos_validados_count.factura_predial %}
                                                    <a type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target='#dialog' data-bs-toggle="tooltip" data-bs-placement="top" title="Cambiar Factura/Predial" hx-target="#document" hx-get="{% url 'subir-documento-factura-predial' proveedor.id %}">
                                                        <i class="fa-duotone fa-regular fa-cloud-arrow-up fa-xl" aria-hidden="true"></i>
                                                    </a>
                                            {% endif %}
                                        {% endif %}      
                            </td>
                            <td class="" id="comentario_8_{{proveedor.id|unlocalize}}" tipo ="factura" >
                                {% if proveedor.comentario_factura %} {{proveedor.comentario_factura}} {% endif %}
                            </td>
                            <td class="d-none" id="form_comentario_8_{{proveedor.id|unlocalize}}">
                                <input type="textarea" class="form-control" id="comentario-input_8_{{ proveedor.id|unlocalize }}" value="{{ proveedor.comentario }}">
                            </td>
                            <td>
                                <a id="modificar_comentario_8_{{proveedor.id|unlocalize}}" class="btn btn-outline-info" onclick="modificar_comentario('{{proveedor.id|unlocalize}}', 8)">
                                    <i class="fa-regular fa-comment"></i>
                                </a>
                                <button type="button" id="save_comment_8_{{proveedor.id|unlocalize}}" onclick="aceptar_edicion('{{proveedor.id|unlocalize}}', 8)"    class="btn btn-outline-primary d-none">
                                    <i class="fa-regular fa-circle-check"></i>
                                </button>
                                <button id="cancel_edit_8_{{proveedor.id|unlocalize}}" type="button" class="btn add-btn d-none" onclick="cancelar_edicion('{{proveedor.id|unlocalize}}', 8)" style="color:ghostwhite; background-color:#980F0F ;">
                                    <i class="fa-solid fa-circle-xmark"></i>
                                </button>
                            </td> 
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "factura_predial" %}
                                        <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="validar_documento_{{ documento.id | unlocalize }}" {% if documento.validado %}checked{% endif %}>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for documento in proveedor.documentos.all %}
                                    {% if documento.tipo_documento == "factura_predial" %}
                                        {% if documento.validada %}
                                            <i class="fa-regular fa-check"></i>
                                        {% else %}
                                            <input type="checkbox" style="transform: scale(1.5); margin: 5px;" name="eliminar_documento_{{ documento.id | unlocalize }}">
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </td>

                        </tr>
                    </tbody>
                </table>
                
            </div>
        </div>
    </div> 
    {% endif %}
</form>
</div>
    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center">
            {% if proveedores_list.has_previous %}
                <li class="page-item"><a class="page-link" style="color:#3E92CC" href="?page=1"><i class="fa-solid fa-angles-left"></i></a></li>
                <li class="page-item"><a class="page-link" style="color:#3E92CC" href="?page={{proveedores_list.previous_page_number}}"><i class="fa-solid fa-angle-left"></i></a></li>
            {% endif %}

            {% for item in proveedores_list.paginator.page_range %}
                {% if proveedores_list.number == item %}
                    <li class="page-item active"><a href="#" class="page-link bg-dark">{{item}}</a></li>
                {% elif item > proveedores_list.number|add:'-2' and item < proveedores_list.number|add:'2' %}
                    <li class="page-item "><a class="page-link" style="color:#3E92CC" href="?page={{item}}" class="page-link">{{item}}</a></li>
                {% endif %}
            {% endfor %}

            {% if proveedores_list.paginator.num_pages > proveedores_list.number|add:'2' %}
            <li><a class="page-link" style="color:#3E92CC" href="?page={{proveedores_list.number|add:'2'}}">&hellip;</a></li>
            <li><a style="color:#3E92CC" href="?page={{ item }}">{{item}}</a></li>
            <li><a class="page-link" style="color:#3E92CC" href="?page={{ proveedores_list.paginator.num_pages}}">{{proveedores_list.paginator.num_pages}}</a></li>
            {% endif %}

            {% if proveedores_list.has_next %}
                <li class="page-item"><a class="page-link" style="color:#3E92CC" href="?page={{proveedores_list.next_page_number}}"><i class="fa-solid fa-chevron-right"></i></a></li>
                <li class="page-item"><a class="page-link" style="color:#3E92CC" href="?page={{proveedores_list.paginator.num_pages}}"><i class="fa-solid fa-angles-right"></i></a></a></li>
            {% endif %}
        </ul>
    </nav>
<!--Este es el modal-->
        <div class="modal fade" id ="dialog" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg modal-dialog-centered" id="document" role="document" hx-target="this">

            </div>
        </div>
</body>
</html>
<!--AJAX CALL-->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script>
    $("#id_familia").change(function () {
      const url = $("#ProductForm").attr("data-subfamilias-url");  // get the url of the `load_subfamilias` view
      const familiaId = $(this).val();  // get the selected familia ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
        data: {
          'familia_id': familiaId       // add the familia id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_subfamilias` view function
          $("#id_subfamilia").html(data);  // replace the contents of the subfamilia input with the data that came from the server
        }
      });
    });

document.addEventListener("submit", function(evt) {
    if (evt.target.matches("form[hx-post]")) {
        console.log("Formulario enviado, mostrando loader...");
        document.getElementById('loadingIndicator').style.display = 'block';
        document.body.style.pointerEvents = 'none'; 
    }
});



(function(){
    const modal = new bootstrap.Modal(document.getElementById('dialog'))

    htmx.on('htmx:beforeSwap', (e) => {
        if (e.detail.target.id === "document" && e.detail.xhr.status === 204) {
            modal.hide();
        }
    });
})();

    //var myModal = document.getElementById('dialog')

    document.addEventListener("htmx:afterRequest", function(evt) {
    console.log("HTMX Request Successful: ", evt.detail.requestConfig.verb);



    if (evt.detail.successful && evt.detail.requestConfig.verb === "post") {
        console.log("Subida exitosa, cerrando modal...");
        var modal = bootstrap.Modal.getInstance(document.querySelector("#dialog"));
        modal.hide();
        
        setTimeout(function(){
            location.reload();
        }, 500);
    }
});

function modificar_comentario(proveedorId, indice){
    var form_comentario = document.getElementById("form_comentario_"+ indice + "_" + proveedorId);
    var comentario = document.getElementById("comentario_"+ indice + "_" + proveedorId);
    //comentario.setAttribute('data-original-comment', comentarioElement.innerHTML);
    var modificar_comentario = document.getElementById("modificar_comentario_"+ indice + "_" + proveedorId);
    var cancel_edit = document.getElementById("cancel_edit_"+ indice + "_" + proveedorId);
    var save_comment = document.getElementById("save_comment_"+ indice + "_" + proveedorId);
    
    form_comentario.classList.remove("d-none");
    comentario.classList.add("d-none");
    modificar_comentario.classList.add("d-none");
    cancel_edit.classList.remove("d-none");
    save_comment.classList.remove("d-none");
};

function cancelar_edicion(proveedorId, indice){
    var form_comentario = document.getElementById("form_comentario_"+ indice + "_" + proveedorId);
    var comentario = document.getElementById("comentario_"+ indice + "_" + proveedorId);
    var edit_quantity = document.getElementById("edit_quantity_"+ indice + "_" + proveedorId);
    var modificar_comentario = document.getElementById("modificar_comentario_"+ indice + "_" + proveedorId);
    var cancel_edit = document.getElementById("cancel_edit_"+ indice + "_" + proveedorId);
    var save_comment = document.getElementById("save_comment_"+ indice + "_" + proveedorId);
    form_comentario.classList.add("d-none");
    comentario.classList.remove("d-none");
    modificar_comentario.classList.remove("d-none");
    cancel_edit.classList.add("d-none");
    save_comment.classList.add("d-none");
};

function aceptar_edicion(proveedorId, indice){
    var form_tag = document.getElementById("form_comentario_"+ indice + "_" + proveedorId);
    var comentario = document.getElementById("comentario_"+ indice + "_" + proveedorId);
    var tipo = comentario.getAttribute("tipo")
    var modificar_comentario = document.getElementById("modificar_comentario_"+ indice + "_" + proveedorId);
    var cancel_edit = document.getElementById("cancel_edit_"+ indice + "_" + proveedorId);
    var save_comment = document.getElementById("save_comment_"+ indice + "_" + proveedorId);
    var pk = proveedorId
   
    var inputElement = document.getElementById('comentario-input_' + indice + "_" + proveedorId).value;
    
    console.log(inputElement)
    ActualizarComentario(pk, inputElement, tipo, indice)
    console.log('proveedor:',pk, 'datos:', inputElement, 'tipo:', tipo, 'indice:', indice, )
    form_tag.classList.add("d-none");
    comentario.classList.remove("d-none");
    modificar_comentario.classList.remove("d-none");
    cancel_edit.classList.add("d-none");
    save_comment.classList.add("d-none");
};

function ActualizarComentario(pk, data, tipo, indice){
    console.log('User is logged in, sending data...' )
    var url = '/dashboard/update_comentario/'
    console.log(url)
    fetch( url, {
        method:'POST',
        headers:{
            'Content-Type':'application/json',
            'X-CSRFToken': csrftoken,
        },
        body:JSON.stringify({'pk':pk,'data':data, 'tipo':tipo, 'indice':indice})
    })
    .then((response)=>{
        return response.json()
    })
    .then((data)=>{
        console.log('data:', data)
        document.getElementById('comentario_'+ indice + '_' + pk).innerHTML = data.dato;
    }
)
}

function toggleVisita(proveedorId) {
    const url = '/dashboard/update_visita/';

    fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': csrftoken,  // asegúrate de tenerlo definido igual que en tus otras funciones
        },
        body: JSON.stringify({'pk': proveedorId})
    })
    .then(response => response.json())
    .then(data => {
        const statusDiv = document.getElementById('visita_status_' + proveedorId);
        if (data.visita) {
            statusDiv.innerHTML = '<i class="fa-solid fa-circle-check text-success fa-xl"></i>';
        } else {
            statusDiv.innerHTML = '<i class="fa-solid fa-circle-xmark text-danger fa-xl"></i>';
        }
    })
    .catch(error => console.error('Error:', error));
}

/* function toggleArrendamiento(proveedorId) {
    const url = '/dashboard/update_visita/';

    fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': csrftoken,  // asegúrate de tenerlo definido igual que en tus otras funciones
        },
        body: JSON.stringify({'pk': proveedorId})
    })
    .then(response => response.json())
    .then(data => {
        const statusDiv = document.getElementById('arrendamiento_status_' + proveedorId);
        if (data.visita) {
            statusDiv.innerHTML = '<i class="fa-solid fa-circle-check text-success fa-xl"></i>';
        } else {
            statusDiv.innerHTML = '<i class="fa-solid fa-circle-xmark text-danger fa-xl"></i>';
        }
    })
    .catch(error => console.error('Error:', error));
}*/

function editarEstatus(id) {
    document.getElementById("estatus_display_" + id).classList.add("d-none");
    document.getElementById("estatus_select_" + id).classList.remove("d-none");
    document.getElementById("edit_btn_" + id).classList.add("d-none");
    document.getElementById("save_btn_" + id).classList.remove("d-none");
    document.getElementById("cancel_btn_" + id).classList.remove("d-none");
}

function cancelarEstatus(id) {
    document.getElementById("estatus_display_" + id).classList.remove("d-none");
    document.getElementById("estatus_select_" + id).classList.add("d-none");
    document.getElementById("edit_btn_" + id).classList.remove("d-none");
    document.getElementById("save_btn_" + id).classList.add("d-none");
    document.getElementById("cancel_btn_" + id).classList.add("d-none");
}

function guardarEstatus(id) {
    const nuevoEstatus = document.getElementById("estatus_select_" + id).value;
    fetch("/proveedores/update_estatus_direccion/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": csrftoken,
        },
        body: JSON.stringify({ id: id, estatus: nuevoEstatus }),
    })
    .then(response => response.json())
    .then(data => {
        document.getElementById("estatus_display_" + id).innerHTML = data.badge_html;
        cancelarEstatus(id);
    });
}
  
function fecha_edit(id){
  document.getElementById('fecha_view_'+id).classList.add('d-none');
  document.getElementById('fecha_edit_'+id).classList.remove('d-none');

  document.getElementById('fecha_btn_edit_'+id).classList.add('d-none');
  document.getElementById('fecha_btn_save_'+id).classList.remove('d-none');
  document.getElementById('fecha_btn_cancel_'+id).classList.remove('d-none');
}

function fecha_cancel(id){
  document.getElementById('fecha_view_'+id).classList.remove('d-none');
  document.getElementById('fecha_edit_'+id).classList.add('d-none');

  document.getElementById('fecha_btn_edit_'+id).classList.remove('d-none');
  document.getElementById('fecha_btn_save_'+id).classList.add('d-none');
  document.getElementById('fecha_btn_cancel_'+id).classList.add('d-none');
}

function fecha_save(id){
  const fechaVal = document.getElementById('fecha_input_'+id).value; // 'YYYY-MM-DD' o ''

  fetch('/proveedores/update_fecha_direccion/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': csrftoken,
    },
    body: JSON.stringify({ id: id, fecha: fechaVal })
  })
  .then(r => r.json())
  .then(data => {
    if (!data.success) return;

    // Actualiza la vista: fecha formateada o ícono si se limpió
    document.getElementById('fecha_view_'+id).innerHTML =
      data.fecha ? data.fecha : '<i class="fa-solid fa-circle-xmark text-danger fa-xl"></i>';

    fecha_cancel(id);
  })
  .catch(console.error);
}
  
  
  </script>


{% endblock %}

<!--style="background-color: #D0D8DC; color:black; font-weight: bold;" -->
<!--style="background-color: #515151; color:white;"-->
<!--style="background-color: #711F1B; color:white;"-->